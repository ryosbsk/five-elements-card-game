# 五行カードバトル ゲーム仕様書

## ゲーム概要

### 基本ルール
- **フィールド**: 3vs3カード配置
- **PP（パワーポイント）**: 1からスタート、毎ターン+1、最大5
- **手札**: 初期3枚、毎ターン1枚補充
- **勝利条件**: 敵カード合計5コスト撃破 または 敵フィールド全滅
- **引き分け**: 両軍フィールド同時全滅

### フェーズシステム
1. **配置フェーズ**: 手札からカードを場に配置
2. **戦闘フェーズ**: スピード順に攻撃対象を手動選択

## 五行相剋システム

### 属性と相剋関係
```
木 → 土 (根が大地を割る)
火 → 金 (炎が金属を溶かす)  
土 → 水 (大地が水を吸い込む)
金 → 木 (刃が木を断つ)
水 → 火 (水が火を鎮める)
```

### ダメージ計算
```javascript
// 基本ダメージ + 相剋ボーナス
const bonus = isEffective ? (cardCost === 1 ? 3 : 5) : 0;
const finalDamage = baseDamage + bonus;
```

- **コスト1カード**: 基本ダメージ + 3
- **コスト2カード**: 基本ダメージ + 5

## カードステータス

### 表示形式
- **🔥2 (属性・コスト)**: 召喚に必要なPP
- **❤️15 (HP)**: カードの体力
- **⚔️12 (攻撃力)**: 与えるダメージ
- **⚡8 (スピード)**: 行動順の優先度

### 属性アイコン
- 🌳 木 (緑系)
- 🔥 火 (赤系)  
- 🏔️ 土 (茶系)
- ⚔️ 金 (銀系)
- 💧 水 (青系)

## UI/UX仕様

### レイアウト構造
```
┌─────────────────────────────────┐
│ 行動順エリア                      │
├─────────────────────────────────┤
│ 敵エリア    [カード1][カード2][カード3] │
│ プレイヤーエリア [カード1][カード2][カード3] │
├─────────────────────────────────┤
│ メッセージエリア                   │
├─────────────────────────────────┤
│ 手札エリア  [手札1][手札2][手札3]    │
└─────────────────────────────────┘
```

### ボタン配置（右利き対応）
- **メインボタン**: 画面右側に配置
- **サブボタン**: 画面左側に配置
- **操作頻度による優先度**: 高頻度→右、低頻度→左

### カラーシステム
- **プレイヤー**: 青系グラデーション
- **敵**: 赤系グラデーション
- **中立**: グレー系
- **アクション**: 緑系（実行可能）、オレンジ系（警告）

## 技術仕様

### ファイル構成
- `index.html`: メインHTML構造
- `script.js`: ゲームロジック・イベント処理
- `style.css`: CSS スタイル定義

### 主要クラス・ID
```css
/* ゲームコンテナ */
#game-container
.game-viewport

/* カード関連 */
.card
.card-slot
.card-content-vertical

/* UI エリア */
.battle-button-area
.turn-order-area
.message-area
.hand-area

/* ボタン */
.battle-btn-circle
.toggle-btn
```

### 重要な関数

#### ゲーム管理
- `initializeGame()`: ゲーム初期化
- `startGame()`: ゲーム開始
- `checkGameEnd()`: 勝敗判定

#### カード管理
- `createCard(cardData)`: カード生成
- `placeCard(card, slot)`: カード配置
- `removeCard(card)`: カード削除

#### 戦闘システム
- `calculateDamage(attacker, defender)`: ダメージ計算
- `isEffective(attackElement, defenseElement)`: 相剋判定
- `executeAttack(attacker, defender)`: 攻撃実行

#### UI更新
- `updateGameState()`: 全体状態更新
- `updateButtonStates()`: ボタン状態更新
- `displayMessage(message)`: メッセージ表示

## デバッグ・トラブルシューティング

### よくある問題
1. **カード選択状態が残る**: `selectableクラス`のリセット不備
2. **ダメージ計算エラー**: 属性データの不整合
3. **フェーズ遷移問題**: 状態管理の不備
4. **UI表示バグ**: DOM更新タイミング問題

### デバッグログパターン
```javascript
console.log('🎯 処理開始:', functionName);
console.log('🔍 入力データ:', inputData);
console.log('📊 中間結果:', intermediateResult);
console.log('✅ 処理完了:', outputData);
console.error('🚨 エラー:', errorDetails);
```

### パフォーマンス最適化
- イベントリスナーの適切な管理
- DOM操作の最小化
- 重複処理の排除
- メモリリークの防止

## 拡張計画

### 実装予定機能
- [ ] カード効果システム
- [ ] アニメーション強化
- [ ] サウンドエフェクト
- [ ] AI対戦モード
- [ ] ランキングシステム

### 技術的改善
- [ ] TypeScript化
- [ ] モジュール分割
- [ ] テストスイート追加
- [ ] CI/CD パイプライン
- [ ] PWA対応