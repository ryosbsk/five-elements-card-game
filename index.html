<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>五行カードバトル</title>
    <link rel="icon" href="data:,"> <!-- favicon 404エラー防止 -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- ゲーム開始画面 -->
    <div id="start-screen" class="start-screen">
        <div class="start-content">
            <h1>🌟 五行カードバトル 🌟</h1>
            <p>五行の力を使って戦略的バトル！</p>
            <div class="game-description">
                <div class="rule-item">⚔️ 3vs3のカードバトル</div>
                <div class="rule-item">💎 PPでカードを召喚</div>
                <div class="rule-item">🏆 敵カード5コスト撃破で勝利</div>
            </div>
            <button id="start-game-btn" class="start-button">
                🎮 ゲーム開始
            </button>
        </div>
    </div>

    <div class="game-container" id="game-container" style="display: none;">
        <!-- 敵エリア -->
        <div class="enemy-area">
            <div class="enemy-info-overlay">
                <span class="area-label">敵</span>
                <span id="enemy-pp">💎 PP: 1/1</span>
                <span id="enemy-victory-counter">🏆 撃破: 0/5</span>
                <span id="enemy-hand-count">💳 手札: 3枚</span>
            </div>
            <div class="battlefield" id="enemy-battlefield">
                <div class="card-slot" id="enemy-slot-0">
                    <div class="empty-slot">空</div>
                </div>
                <div class="card-slot" id="enemy-slot-1">
                    <div class="empty-slot">空</div>
                </div>
                <div class="card-slot" id="enemy-slot-2">
                    <div class="empty-slot">空</div>
                </div>
            </div>
        </div>

        <!-- プレイヤーエリア -->
        <div class="player-area">
            <div class="battlefield" id="player-battlefield">
                <div class="card-slot" id="player-slot-0">
                    <div class="empty-slot">空</div>
                </div>
                <div class="card-slot" id="player-slot-1">
                    <div class="empty-slot">空</div>
                </div>
                <div class="card-slot" id="player-slot-2">
                    <div class="empty-slot">空</div>
                </div>
            </div>
        </div>

        <!-- 行動順表示 -->
        <div class="turn-order-area">
            <div class="turn-order-card">
                <div class="info-title">行動順</div>
                <div id="turn-order" class="turn-order-list">
                    <!-- 行動順がここに表示される -->
                </div>
            </div>
        </div>

        <!-- プレイヤー統合コントロールゾーン -->
        <div class="player-control-zone">
            <!-- プレイヤー情報ヘッダー -->
            <div class="player-info-header">
                <div class="info-badge phase-display" id="current-phase">ゲーム開始</div>
                <div class="info-badge turn-display" id="turn-counter">ターン: 1</div>
                <div class="info-badge pp-display" id="pp-counter">💎 PP: 1/1</div>
                <div class="info-badge victory-display" id="victory-counter">🏆 撃破: 0/5</div>
            </div>

            <!-- 手札エリア -->
            <div class="hand-section">
                <div class="section-header">手札</div>
                <div class="hand-cards" id="player-hand">
                    <!-- 手札のカードがここに表示される -->
                </div>
            </div>

            <!-- コントロール -->
            <div class="controls">
                <button id="restart-btn" class="action-button restart">ゲーム再開</button>
                <button id="skip-action-btn" class="action-button secondary">行動スキップ</button>
                <button id="end-turn-btn" class="action-button primary">ターン終了</button>
            </div>

            <!-- メッセージ -->
            <div class="message-section">
                <div id="game-message" class="current-message">
                    ゲームを開始します！手札からカードを選んでクリックしてください。
                </div>
                <details class="message-history-details">
                    <summary class="message-history-toggle">📜 履歴</summary>
                    <div id="message-history-list" class="message-history-list">
                        <!-- 履歴がここに表示される -->
                    </div>
                </details>
            </div>
        </div>

        <!-- ゲーム背景（攻撃キャンセル用） -->
        <div id="game-background" class="game-background"></div>
    </div>

    <!-- マリガンシステムは自動化により削除済み -->

    <!-- 統合コントロールパネル（右下固定） -->
    <div class="control-panel" id="control-panel" style="display: none;">
        <button id="help-toggle" class="control-btn" title="相剋表を表示">
            ❓
        </button>
        <button id="audio-toggle" class="control-btn" title="音響設定">
            🔊
        </button>
        <div id="audio-panel" class="audio-panel" style="display: none;">
            <div class="audio-setting">
                <label>🎵 BGM</label>
                <div class="audio-control-row">
                    <button id="bgm-toggle" class="toggle-btn">ON</button>
                    <input type="range" id="bgm-volume" min="0" max="100" value="30" class="volume-slider">
                </div>
            </div>
            <div class="audio-setting">
                <label>🔊 SE</label>
                <div class="audio-control-row">
                    <button id="se-toggle" class="toggle-btn">ON</button>
                    <input type="range" id="se-volume" min="0" max="100" value="70" class="volume-slider">
                </div>
            </div>
            <button id="audio-close" class="close-btn">×</button>
        </div>
    </div>

    <!-- ヘルプモーダル -->
    <div id="help-modal" class="help-modal" style="display: none;">
        <div class="help-content">
            <h3>🌟 五行カードバトル ガイド</h3>
            
            <!-- タブナビゲーション -->
            <div class="help-tabs">
                <button class="help-tab-btn active" data-tab="basic-rules">📋 基本ルール</button>
                <button class="help-tab-btn" data-tab="effectiveness">⚔️ 相剋表</button>
                <button class="help-tab-btn" data-tab="strategy">💡 戦略ヒント</button>
                <button class="help-tab-btn" data-tab="faq">❓ FAQ</button>
            </div>
            
            <!-- タブコンテンツエリア -->
            <div class="help-tab-content">
                
                <!-- 📋 基本ルール タブ -->
                <div id="basic-rules-tab" class="tab-panel active">
                    <h4>🎯 ゲームの目標</h4>
                    <div class="rule-section">
                        <p><strong>勝利条件:</strong> 敵カード合計5コスト撃破 または 敵フィールド全滅</p>
                        <p><strong>引き分け:</strong> 両軍フィールドが同時に全滅</p>
                    </div>
                    
                    <h4>⚔️ バトルシステム</h4>
                    <div class="rule-section">
                        <p><strong>3vs3バトル:</strong> 最大3枚のカードでフィールドを構築</p>
                        <p><strong>ターン制:</strong> カードのスピード値が高い順に行動</p>
                        <p><strong>同スピード:</strong> 同時に攻撃し、相打ちになる</p>
                    </div>
                    
                    <h4>💎 PPシステム</h4>
                    <div class="rule-section">
                        <p><strong>初期PP:</strong> 1PP、手札3枚でスタート</p>
                        <p><strong>PP増加:</strong> 毎ターン+1PP（最大5PP）</p>
                        <p><strong>カード配置:</strong> 手札からカードをPPコストで配置</p>
                    </div>
                </div>
                
                <!-- ⚔️ 相剋表 タブ -->
                <div id="effectiveness-tab" class="tab-panel">
                    <h4>🌟 五行相剋システム</h4>
                    <p class="help-description">攻撃属性が防御属性に効果的な場合、<strong>コスト1は+3ダメージ、コスト2は+5ダメージ</strong>になります</p>
                    
                    <div class="effectiveness-grid">
                        <div class="effect-row">
                            <span class="attacker 木">木</span>
                            <span class="arrow">→</span>
                            <span class="defender 土">土</span>
                            <span class="damage">+3/+5</span>
                            <span class="description">根が大地を割る</span>
                        </div>
                        <div class="effect-row">
                            <span class="attacker 火">火</span>
                            <span class="arrow">→</span>
                            <span class="defender 金">金</span>
                            <span class="damage">+3/+5</span>
                            <span class="description">炎が金属を溶かす</span>
                        </div>
                        <div class="effect-row">
                            <span class="attacker 土">土</span>
                            <span class="arrow">→</span>
                            <span class="defender 水">水</span>
                            <span class="damage">+3/+5</span>
                            <span class="description">大地が水を吸い込む</span>
                        </div>
                        <div class="effect-row">
                            <span class="attacker 金">金</span>
                            <span class="arrow">→</span>
                            <span class="defender 木">木</span>
                            <span class="damage">+3/+5</span>
                            <span class="description">刃が木を断つ</span>
                        </div>
                        <div class="effect-row">
                            <span class="attacker 水">水</span>
                            <span class="arrow">→</span>
                            <span class="defender 火">火</span>
                            <span class="damage">+3/+5</span>
                            <span class="description">水が火を鎮める</span>
                        </div>
                    </div>
                </div>
                
                <!-- 💡 戦略ヒント タブ -->
                <div id="strategy-tab" class="tab-panel">
                    <h4>🧠 基本戦術</h4>
                    <div class="strategy-section">
                        <h5>💎 PP管理</h5>
                        <ul>
                            <li>序盤はコスト1カードで手札を温存</li>
                            <li>PP2-3でコスト2カードの投入を検討</li>
                            <li>一度に全カードを使わず、継続戦を意識</li>
                        </ul>
                        
                        <h5>⚔️ 相剋活用</h5>
                        <ul>
                            <li>敵の属性を見て有利なカードを配置</li>
                            <li>コスト2なら+5の大ダメージを狙える</li>
                            <li>劣勢時は相剋で逆転を狙う</li>
                        </ul>
                        
                        <h5>⚡ スピード戦術</h5>
                        <ul>
                            <li>高スピードカードで先制攻撃</li>
                            <li>同スピードなら相打ち覚悟で攻撃</li>
                            <li>低スピードでも高耐久なら有効</li>
                        </ul>
                    </div>
                </div>
                
                <!-- ❓ FAQ タブ -->
                <div id="faq-tab" class="tab-panel">
                    <h4>❓ よくある質問</h4>
                    <div class="faq-section">
                        <div class="faq-item">
                            <h5>🎮 基本操作</h5>
                            <p><strong>Q:</strong> カードはどうやって使うの？</p>
                            <p><strong>A:</strong> 手札のカードをクリックすると、フィールドの空きスロットに配置されます。</p>
                        </div>
                        
                        <div class="faq-item">
                            <h5>⚔️ 戦闘について</h5>
                            <p><strong>Q:</strong> 攻撃はいつ始まるの？</p>
                            <p><strong>A:</strong> 「ターン終了」ボタンを押すと、スピード順に自動で戦闘が進行します。</p>
                        </div>
                        
                        <div class="faq-item">
                            <h5>💎 PPについて</h5>
                            <p><strong>Q:</strong> PPが足りない時は？</p>
                            <p><strong>A:</strong> 「行動スキップ」でターンを進めてPPを増やすか、低コストカードを使いましょう。</p>
                        </div>
                        
                        <div class="faq-item">
                            <h5>🏆 勝利条件</h5>
                            <p><strong>Q:</strong> どうなったら勝ち？</p>
                            <p><strong>A:</strong> 敵カード合計5コスト撃破 または 敵フィールドを全滅させると勝利です。</p>
                        </div>
                    </div>
                </div>
                
            </div>
            
            <button id="help-close" class="help-close-btn">閉じる</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>